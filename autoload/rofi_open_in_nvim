# depends: rofi nvim alacritty

rofi_open_in_nvim() (
    DIR="$1"
    if [ -z "$DIR" ]; then
        DIR="$(pwd)"
    fi

    cd "$DIR"

    selection=$(
        for entry in *; do
            printf "$entry\n"
        done | rofi -dmenu -p $(basename "$DIR")
    )
    [ -z "$selection" ] && return 1

    WORKDIR="${DIR}/${selection}"
    alacritty --working-directory "$WORKDIR" -e nvim . &
    sleep 0.1 # ensure order of windows, sometimes zsh starts too fast
    alacritty --working-directory "$WORKDIR" -e zsh &
)
